# 곡선형 플레이 영역 시스템 기획서

## 1. 시스템 개요
기존의 직사각형 플레이 영역 대신 상단이 곡선으로 된 형태의 독특한 플레이 영역을 도입하여 랜덤성과 전략성을 동시에 확보하는 시스템입니다.

---

## 2. 곡선형 플레이 영역 디자인

### 기본 형태
- **하단**: 직선 (발사 영역)
- **좌우**: 직선 (벽면)
- **상단**: 곡선 (새로운 특징!)
  - 포물선 또는 타원형 곡선
  - 중앙이 가장 높고 양쪽으로 갈수록 낮아짐
  - 전체적으로 둥근 돔 같은 형태

### 곡선의 종류
#### 타입 A: 포물선형
```
      ∩
    /   \
   /     \
  /       \
 /         \
|           |
|           |
|___________|
```

#### 타입 B: 타원형
```
    ___
  /     \
 /       \
|         |
|         |
|_________|
```

#### 타입 C: 불규칙 곡선
```
   ∿∩∿
  /    \
 /      \
|        |
|        |
|________|
```

---

## 3. 게임플레이에 미치는 영향

### 랜덤성 확보
1. **예측 불가능한 정착**:
   - 곡선 상단에 닿은 비눗방울이 어느 방향으로 굴러갈지 예측 어려움
   - 같은 위치에 발사해도 매번 다른 결과
   - 운의 요소가 추가되어 게임의 재미 증가

2. **자연스러운 흩어짐**:
   - 곡선을 따라 비눗방울이 자연스럽게 분산
   - 한쪽에만 몰리는 것 방지
   - 더 다양한 패턴 생성 가능

### 전략성 향상
1. **곡선 활용 전략**:
   - 곡선의 경사를 이용한 의도적 굴리기
   - 높은 부분에서 낮은 부분으로의 자연스러운 이동
   - 곡선의 특정 지점을 노리는 고급 테크닉

2. **위치별 특성**:
   - **중앙 상단**: 가장 높음, 좌우로 굴러갈 확률 50:50
   - **중간 지점**: 한쪽으로 굴러갈 확률 높음
   - **모서리**: 벽 근처로 바로 떨어짐

---

## 4. 곡선 형태별 특성

### 완만한 곡선 (Easy 모드)
- **특징**: 부드러운 경사, 예측 가능성 높음
- **장점**: 초보자도 어느 정도 예측 가능
- **전략**: 곡선의 기울기를 이용한 의도적 배치

### 급한 곡선 (Normal 모드)
- **특징**: 중간 정도의 경사, 적당한 랜덤성
- **장점**: 전략과 운의 균형
- **전략**: 경험을 통한 확률적 예측

### 불규칙 곡선 (Hard 모드)
- **특징**: 울퉁불퉁한 형태, 높은 랜덤성
- **장점**: 매번 새로운 도전
- **전략**: 순간 판단력과 적응력 중요

---

## 5. 물리 시뮬레이션 적용

### 곡선 충돌 처리
```swift
// 곡선과의 충돌 감지 및 반사 처리
func handleCurvedBoundaryCollision(bubble: BubbleNode, curvePoint: CGPoint) {
    // 곡선의 접선 벡터 계산
    let tangentVector = calculateTangent(at: curvePoint)
    
    // 법선 벡터 계산 (반사 방향)
    let normalVector = perpendicular(to: tangentVector)
    
    // 반사 속도 계산
    let reflectedVelocity = reflect(bubble.velocity, normal: normalVector)
    
    // 감쇠 적용 (에너지 손실)
    bubble.velocity = reflectedVelocity * dampingFactor
}
```

### 굴러가기 효과
- **중력의 영향**: 곡선을 따라 자연스럽게 굴러감
- **마찰력**: 곡선 표면에서의 마찰로 속도 조절
- **탄성**: 곡선에 부딪혔을 때의 반발력

---

## 6. 시각적 표현

### 곡선 디자인
- **재질**: 투명한 크리스털 느낌의 경계선
- **효과**: 은은한 광택과 반사 효과
- **색상**: 배경과 조화를 이루는 연한 색상
- **애니메이션**: 미세한 빛의 흐름 효과

### 곡선 가이드라인
- **격자 표시**: 곡선 영역에 보조 격자 (옵션)
- **높이 표시**: 곡선의 높이를 나타내는 등고선
- **위험 구역**: 게임 오버에 가까운 영역 색상 변화

---

## 7. 게임 모드별 곡선 적용

### 클래식 모드
- **고정 곡선**: 항상 같은 형태의 곡선
- **학습 가능**: 플레이어가 곡선의 특성 파악 가능
- **전략 중심**: 곡선을 활용한 전략 개발

### 랜덤 모드
- **변화하는 곡선**: 게임마다 다른 형태의 곡선
- **높은 랜덤성**: 매번 새로운 도전
- **적응력 중심**: 빠른 상황 판단 필요

### 진화 모드
- **점진적 변화**: 게임 진행에 따라 곡선이 변화
- **난이도 증가**: 시간이 지날수록 더 복잡한 곡선
- **긴장감 증가**: 예측하기 어려워지는 플레이

---

## 8. 전략적 요소

### 곡선 읽기
- **경사 분석**: 곡선의 기울기를 보고 굴러갈 방향 예상
- **높이 차이**: 높은 곳에서 낮은 곳으로의 자연스러운 흐름
- **반사 각도**: 곡선에 부딪혔을 때의 반사 방향 계산

### 고급 테크닉
- **곡선 바운스**: 곡선을 이용한 의도적 반사
- **중력 활용**: 곡선의 경사를 이용한 자연스러운 이동
- **타이밍 조절**: 곡선 특성에 맞는 발사 타이밍

---

## 9. 밸런스 조정

### 곡선의 영향도 조절
- **경사도**: 곡선의 기울기 정도
- **높이 차이**: 중앙과 양쪽의 높이 차이
- **표면 마찰**: 곡선 표면의 마찰 계수

### 난이도별 설정
- **초급**: 완만한 곡선, 예측 가능성 높음
- **중급**: 적당한 곡선, 균형잡힌 랜덤성
- **고급**: 급한 곡선, 높은 불확실성

---

## 10. 플레이어 반응 예상

### 긍정적 효과
- **신선함**: 기존 게임과 다른 독특한 플레이 경험
- **재플레이성**: 랜덤 요소로 인한 높은 재플레이 가치
- **전략성**: 곡선을 활용한 새로운 전략 개발

### 학습 곡선
- **초기**: 곡선의 특성 파악 단계
- **중기**: 곡선을 활용한 기본 전략 개발
- **고급**: 복잡한 곡선 활용 고급 테크닉

---

## 11. 구현 고려사항

### 곡선 수식
```swift
// 포물선 곡선 공식
func parabolicCurve(x: CGFloat, width: CGFloat, height: CGFloat) -> CGFloat {
    let normalizedX = (x / width - 0.5) * 2  // -1 to 1
    return height * (1 - normalizedX * normalizedX)
}

// 타원 곡선 공식
func ellipticalCurve(x: CGFloat, width: CGFloat, height: CGFloat) -> CGFloat {
    let normalizedX = (x / width - 0.5) * 2  // -1 to 1
    return height * sqrt(1 - normalizedX * normalizedX)
}
```

### 충돌 감지 최적화
- **베지어 곡선**: 부드러운 곡선 표현
- **분할 알고리즘**: 곡선을 작은 선분들로 나누어 충돌 처리
- **캐싱**: 곡선 계산 결과 캐싱으로 성능 향상

---

이 곡선형 플레이 영역 시스템을 도입하면 기존의 예측 가능한 게임플레이에 신선한 랜덤성과 전략성을 동시에 추가할 수 있어, 플레이어들에게 매번 새로운 도전과 재미를 제공할 수 있습니다!