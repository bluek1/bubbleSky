# 캐릭터 기반 패닝 발사 시스템 상세 기획서

## 1. 시스템 개요
캐릭터가 랜덤 크기의 비눗방울을 생성하고, 플레이어가 패닝으로 위치를 조절한 후 놓으면 자동으로 위로 상승하는 직관적인 발사 시스템입니다.

---

## 2. 게임 플레이 흐름

### 단계 1: 비눗방울 생성
- **캐릭터 애니메이션**: 
  - 화면 하단 중앙에 위치한 캐릭터가 비눗방울 생성 애니메이션
  - 입으로 후~하고 불어서 비눗방울 생성
  - 생성 과정에서 크기가 점점 커지는 애니메이션
- **랜덤 크기 결정**:
  - 7가지 크기 중 랜덤 선택 (tiny~mega)
  - 확률 가중치: 작은 크기가 더 자주 나옴
  - 시각적 표시: 비눗방울이 완성되면 크기 확정

### 단계 2: 위치 조절 (패닝)
- **패닝 조작**:
  - 생성된 비눗방울을 좌우로 드래그하여 위치 조절
  - 화면 너비 내에서만 이동 가능
  - 실시간으로 부드러운 이동 애니메이션
- **시각적 피드백**:
  - 이동 중 비눗방울 아래에 그림자 표시
  - 세로 가이드라인으로 발사 경로 예상
  - 최적 위치에서 가이드라인 색상 변화

### 단계 3: 발사 (손가락 떼기)
- **자동 상승**:
  - 손가락을 떼는 순간 비눗방울이 수직 상승
  - 중력의 영향을 받아 자연스러운 포물선 궤적
  - 발사 순간 "퐁!" 효과음과 파티클 효과

---

## 3. 캐릭터 시스템

### 캐릭터 종류 및 특성
#### 기본 캐릭터: 비눗방울 요정
- **외형**: 작고 귀여운 요정 모습
- **애니메이션**: 날개를 파닥이며 비눗방울 생성
- **특성**: 균등한 확률로 모든 크기 생성

#### 특별 캐릭터들:
1. **꼬마 드래곤**
   - 작은 크기 비눗방울 전문 (tiny, small 70% 확률)
   - 연속 생성 속도 빠름
   
2. **마법사 토끼**
   - 중간 크기 비눗방울 특화 (medium, large 60% 확률)
   - 가끔 무지개 비눗방울 생성 (특수 효과)
   
3. **고래 캐릭터**
   - 큰 크기 비눗방울 전문 (huge, giant, mega 50% 확률)
   - 생성 속도는 느리지만 임팩트 큼

### 캐릭터별 애니메이션
- **대기 상태**: 살짝 위아래로 떠다니는 idle 애니메이션
- **생성 준비**: 심호흡하며 준비하는 모션
- **비눗방울 생성**: 입으로 불어서 비눗방울 만드는 애니메이션
- **발사 후**: 만족스러운 표정으로 다음 비눗방울 준비

---

## 4. 패닝 조작 시스템

### 조작 방법
```
1. 비눗방울 터치 → 패닝 모드 시작
2. 좌우 드래그 → 비눗방울 위치 이동
3. 손가락 떼기 → 그 위치에서 자동 발사
```

### 이동 제한
- **좌우 범위**: 화면 너비의 90% 내에서만 이동
- **세이프 존**: 양쪽 끝에 작은 여백으로 경계 명확히
- **스냅 기능**: 화면 경계 근처에서 자동으로 스냅

### 시각적 가이드
- **이동 트레일**: 비눗방울 이동 경로에 투명한 트레일 효과
- **세로 가이드라인**: 현재 위치에서 위로 향하는 점선
- **착지 예상 영역**: 상단에 착지할 예상 위치 하이라이트
- **최적 위치 표시**: 전략적으로 좋은 위치에서 가이드 색상 변화

---

## 5. 물리 시뮬레이션

### 발사 메커니즘
- **초기 속도**: 비눗방울 크기에 따라 차등 적용
  - 작은 비눗방울: 빠른 초기 속도
  - 큰 비눗방울: 느린 초기 속도
- **중력 적용**: 발사 후 즉시 중력의 영향을 받음
- **공기 저항**: 크기가 클수록 공기 저항 증가

### 특수 효과
- **크기별 차이**:
  - Tiny: 가볍게 떠오르며 바람에 흔들림
  - Medium: 안정적인 직선 상승
  - Mega: 무겁게 천천히 상승하지만 강한 임팩트

---

## 6. 랜덤 시스템

### 확률 분포 (수정됨)
```
Tiny (1):    35% 확률 (증가)
Small (2):   35% 확률 (증가)
Medium (3):  30% 확률 (증가)
Large (4):   0% 확률 (생성 안됨)
Huge (5):    0% 확률 (생성 안됨)
Giant (6):   0% 확률 (생성 안됨)
Mega (7):    0% 확률 (생성 안됨)
```

**중요**: Large 이상의 비눗방울은 랜덤 생성되지 않고 오직 합치기를 통해서만 생성 가능

### 연속 방지 시스템
- **연속 제한**: 같은 크기가 3번 연속 나오면 다른 크기 강제 생성
- **밸런스 조정**: Tiny, Small, Medium 간의 균형 유지
- **럭키 타임**: 가끔 Medium이 연속으로 나오는 특별한 순간

---

## 7. UI/UX 디자인

### 인터페이스 레이아웃
- **상단**: 점수, 다음 비눗방울 미리보기
- **중앙**: 게임 플레이 영역
- **하단**: 캐릭터와 현재 비눗방울
- **가이드**: 패닝 시에만 나타나는 보조선들

### 터치 피드백
- **햅틱**: 비눗방울 터치 시 가벼운 진동
- **사운드**: 이동 중 부드러운 "윙윙" 소리
- **비주얼**: 터치 중 비눗방울이 살짝 커지는 효과

---

## 8. 게임플레이 전략

### 플레이어 전략 요소
1. **위치 선택**: 어디에 떨어뜨릴지 신중한 판단
2. **연쇄 계획**: 미래의 합치기를 고려한 배치
3. **공간 관리**: 제한된 공간 효율적 사용
4. **랜덤 대응**: 예상치 못한 크기에 대한 빠른 적응

### 난이도 곡선
- **초급**: 큰 비눗방울 확률 증가, 가이드 강화
- **중급**: 표준 확률, 기본 가이드
- **고급**: 작은 비눗방울 확률 증가, 최소 가이드

---

## 9. 특수 기능

### 캐릭터 스킬 시스템
- **스킬 게이지**: 연속 성공 시 게이지 충전
- **특수 능력**: 
  - 크기 선택: 다음 비눗방울 크기를 플레이어가 선택
  - 2연발: 한 번에 두 개의 비눗방울 생성
  - 거대화: 모든 비눗방울이 한 단계 크기 증가

### 파워업 아이템
- **정확도 향상**: 가이드라인 강화
- **크기 조정**: 생성된 비눗방울 크기 ±1 조절 가능
- **시간 정지**: 잠깐 시간을 멈춰서 위치 신중히 선택

---

## 10. 기술적 구현

### 터치 처리
```swift
// 패닝 감지 및 위치 업데이트
func handlePanGesture(_ gesture: UIPanGestureRecognizer) {
    let translation = gesture.translation(in: gameView)
    let newPosition = clampPosition(bubble.position.x + translation.x)
    updateBubblePosition(newPosition)
    updateVisualGuides(newPosition)
}
```

### 애니메이션 시스템
- **캐릭터 애니메이션**: SKAction 시퀀스로 부드러운 연출
- **비눗방울 생성**: 크기 변화와 투명도 조절
- **패닝 트레일**: 파티클 시스템으로 움직임 표현

---

이 시스템을 통해 플레이어는 매우 직관적이면서도 전략적인 게임플레이를 즐길 수 있으며, 캐릭터의 개성과 랜덤 요소가 더해져 매번 새로운 재미를 제공할 수 있습니다.
